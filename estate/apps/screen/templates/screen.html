{% extends 'base.html' %}{% load staticfiles %}
{% block App %}
    <div class="container">
        <form id="screen-add" class="bg-light pl-4 pr-4" enctype="multipart/form-data" method="post">
            <p class="h2 pt-4 pb-4 text-center">Screen Add</p>
            {% csrf_token %}
            <div class="form-group">
                <select class="form-control" name="advert">
                    {% for advert in adverts %}
                        <option value="{{ advert.pk }}">{{ advert }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <input type="text" name="name" class="form-control" placeholder="Screen ID" required>
            </div>
            <div class="form-group">
                <input type="text" name="title" class="form-control" placeholder="Title" required>
            </div>
            <div class="form-group">
                <input type="number" name="hfov" class="form-control" placeholder="Hfov" required>
            </div>
            <div class="form-group">
                <input type="number" name="pitch" class="form-control" placeholder="Pitch" required>
            </div>
            <div class="form-group">
                <input type="number" name="yaw" class="form-control" placeholder="Yaw" required>
            </div>
            <div class="form-group">
                <input type="number" name="northOffset" class="form-control" placeholder="NorthOffset" required>
            </div>
            <div class="form-group">
                <input type="number" name="order" class="form-control" placeholder="Order" required>
            </div>
            <div class="form-group">
                <input type="file" name="image" class="form-control-file" required>
            </div>
            <div class="pb-3">
                <div class="form-preloader">
                    <div class="spinner-grow text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-secondary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-success" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-danger" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-warning" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-info" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-dark" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary ml-auto mr-auto w-50 d-block">Save</button>
                <p class="alert alert-success mt-4 text-center form-success">Uploaded Successfully</p>
                <p class="alert alert-danger mt-4 text-center form-error">There is a problem</p>
            </div>
        </form>
    </div>
{% endblock %}
{% block Scripts %}
    <script type="text/javascript">
        $('#screen-add').on('submit', function (e) {
            e.preventDefault();
            const data = new FormData(this);
            const preloader = $('.form-preloader');
            const formSuccess = $('.form-success');
            const formError = $('.form-error');
            preloader.show();
            $.ajax({
                method: 'POST',
                url: '/api/screen/',
                data,
                enctype: 'multipart/form-data',
                contentType: false,
                cache: false,
                processData: false,
                success: function (res) {
                    preloader.hide();
                    formSuccess.show();
                },
                error: function (err) {
                    preloader.hide();
                    formError.show();
                }
            });
        });
    </script>
{% endblock %}